var internals = {};

exports = module.exports = internals.Reporter = function (options) {

    this.settings = options;
};

internals.Reporter.convert = function (results) {

    var totalDuration = results.duration;
    var totalTests = 0;
    var testsOutput= '';
    var failures = 0;
    var passes = 0;
    //console.log(results.tests);
    Object.keys(results.tests).forEach(function(experiments) {

        //console.log(results.tests[experiments]);
        //console.log(experiments);
        for (var i = 0; i < results.tests[experiments].length; i++) {

            totalTests++;
            var title = experiments+ ' ' + totalTests + ' ' + results.tests[experiments][i].title;
            var duration = results.tests[experiments][i].duration;
            var durationJenkins = duration / 1000;
            var err = results.tests[experiments][i].err;
            if (err) {

                failures++;
                var short_err = err.split('\n\n\t')[0];
                var details = err.toString().replace(/</g,'&lt;').replace(/>/g, '&gt;');
                testsOutput += 'not ok ' + i + ' ' + title + '\n';
                testsOutput += '  ---' + '\n';
                testsOutput += '  duration: ' + duration + '\n';
                testsOutput += '  duration_ms: ' + durationJenkins + '\n';
                testsOutput += '  short_err: ' + short_err + '\n';
                testsOutput += '  details: ' + details + '\n';
                testsOutput += '  ...' + '\n';
            }
            else
            {

                passes++;
                testsOutput += 'ok ' + totalTests + ' ' + title + '\n';
                testsOutput += '  ---' + '\n';
                testsOutput += '  duration: ' + duration + '\n';
                testsOutput += '  duration_ms: ' + durationJenkins + '\n';
                testsOutput += '  ...' + '\n';
            }
        }
    });
    console.log('1..' + totalTests + '\n');
    console.log(testsOutput);
};
